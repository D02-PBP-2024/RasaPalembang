{% extends 'base.html' %}

{% block meta %}
<title>RasaPalembang | Edit Makanan</title>
<style>
    /* Animasi untuk progress bar */
    .progress-bar {
        width: 0;
        height: 4px;
        background-color: #4f9da6;
        position: absolute;
        top: 0;
        left: 0;
        z-index: 50;
        animation: load 3s ease-out forwards;
    }

    @keyframes load {
        0% {
            width: 0;
        }

        100% {
            width: 100%;
        }
    }

    /* Chips design */
    .chips-wrapper {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
    }

    .chip {
        padding: 10px 15px;
        background-color: #4f9da6;
        color: white;
        border-radius: 20px;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .chip:hover {
        background-color: #3b747a;
    }

    .chip.active {
        background-color: #ff5757; /* Warna ketika kategori dipilih */
    }

    .hidden-input {
        display: none;
    }
</style>
{% endblock meta %}

{% block content %}
<main class="py-10">
    <!-- Progress Bar Animasi -->
    <div class="progress-bar"></div>

    <!-- Menambahkan margin-top 5rem pada form container -->
    <div class="max-w-2xl mx-auto p-8 bg-white shadow-lg rounded-lg mt-20">
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-700">Edit Makanan</h1>

        <!-- Tambahkan ini untuk memuat widget_tweaks -->
        {% load widget_tweaks %}

        <!-- Form untuk edit makanan -->
        <form method="post" enctype="multipart/form-data" class="grid grid-cols-1 gap-6">
            {% csrf_token %}
            <div>
                <label for="nama" class="block text-lg text-gray-600 font-semibold">Nama Makanan</label>
                {{ form.nama|add_class:"w-full mt-2 bg-gray-100 rounded px-4 py-3.5 placeholder:text-[#808080] focus:outline-none focus:ring-2 focus:ring-[#4f9da6] focus:border-transparent" }}
            </div>

            <div>
                <label for="harga" class="block text-lg text-gray-600 font-semibold">Harga</label>
                {{ form.harga|add_class:"w-full mt-2 bg-gray-100 rounded px-4 py-3.5 placeholder:text-[#808080] focus:outline-none focus:ring-2 focus:ring-[#4f9da6] focus:border-transparent" }}
            </div>

            <div>
                <label for="deskripsi" class="block text-lg text-gray-600 font-semibold">Deskripsi</label>
                {{ form.deskripsi|add_class:"w-full resize-none h-36 mt-2 bg-gray-100 rounded px-4 py-3.5 placeholder:text-[#808080] focus:outline-none focus:ring-2 focus:ring-[#4f9da6] focus:border-transparent" }}
            </div>

            <div>
                <label for="gambar" class="block text-lg text-gray-600 font-semibold">Gambar</label>
                <div class="mt-2 flex items-center">
                    <label for="gambar" class="w-full overflow-hidden relative cursor-pointer bg-gray-100 rounded font-medium text-[#4f9da6] hover:text-[#3b747a] px-4 py-3.5 text-center focus-visible:outline-[#4f9da6]">
                        <span id="gambar-file">Upload gambar</span>
                        <input id="gambar" name="gambar" type="file" class="sr-only">
                    </label>
                </div>
            </div>

            <div>
                <label for="kalori" class="block text-lg text-gray-600 font-semibold">Kalori</label>
                {{ form.kalori|add_class:"w-full mt-2 bg-gray-100 rounded px-4 py-3.5 placeholder:text-[#808080] focus:outline-none focus:ring-2 focus:ring-[#4f9da6] focus:border-transparent" }}
            </div>

            <div>
                <label for="restoran" class="block text-lg text-gray-600 font-semibold">Restoran</label>
                {{ form.restoran|add_class:"w-full mt-2 bg-gray-100 rounded px-4 py-3.5 placeholder:text-[#808080] focus:outline-none focus:ring-2 focus:ring-[#4f9da6] focus:border-transparent" }}
            </div>

            <!-- Chips Design untuk Kategori -->
            <div>
                <label class="block text-lg text-gray-600 font-semibold">Kategori</label>
                <div class="chips-wrapper">
                    {% for kategori in form.kategori.field.queryset %}
                    <span class="chip" data-id="{{ kategori.id }}">{{ kategori.nama }}</span>
                    <input type="checkbox" name="kategori" value="{{ kategori.id }}" class="hidden-input">
                    {% endfor %}
                </div>
            </div>

            <!-- Tombol Edit -->
            <button type="submit"
                class="w-full py-3 bg-[#4f9da6] hover:bg-[#3b747a] text-white font-bold rounded-md transition duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-green-300">
                Edit Makanan
            </button>
        </form>

        <!-- Kembali ke Daftar Makanan -->
        <div class="mt-6 text-center">
            <a href="{% url 'makanan:show_makanan' %}"
                class="text-lg text-[#d04848] hover:text-[#ff5757] transition-all duration-200">Kembali ke Daftar Makanan</a>
        </div>
    </div>
</main>

<script>
var gambarUpload = document.getElementById('gambar')
var gambarFile = document.getElementById('gambar-file')
gambarUpload.addEventListener('change', function() {
    gambarFile.innerText = gambarUpload.files[0].name
})

// JS untuk handle chips selection
document.querySelectorAll('.chip').forEach(function(chip) {
    chip.addEventListener('click', function() {
        const input = this.nextElementSibling;  // Menghubungkan dengan input checkbox di sebelahnya
        this.classList.toggle('active');  // Toggle class active (highlight chip)
        input.checked = !input.checked;  // Toggle checkbox state
    });
});
</script>
{% endblock %}